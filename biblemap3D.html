<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <title>Bible Map</title>

    <link rel="shortcut icon" href="http://www.biblemap.or.kr/favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="http://www.biblemap.or.kr/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" type="text/css" media="all" href="http://fonts.googleapis.com/earlyaccess/nanumgothic.css">
    <link rel="stylesheet" type="text/css" media="all" href="http://fonts.googleapis.com/earlyaccess/hanna.css">
    <!-- <link rel="stylesheet" href="https://openlayers.org/en/v4.1.1/css/ol.css" type="text/css"> -->
    <link rel="stylesheet" href="https://openlayers.org/en/v4.4.2/css/ol.css" type="text/css">
    <link rel="stylesheet" href="biblemap/css/expandmenu.css?version=20170917">
    <!-- <link rel="stylesheet" href="biblemap/ol-cesium-v1.32/ol.css" type="text/css"> -->
    <link rel="stylesheet" href="ol-cesium/ol.css" type="text/css">

    <meta name="viewport" content="width=device-width">
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
    <!-- <script src="https://api.mapbox.com/mapbox.js/plugins/arc.js/v0.1.0/arc.js"></script> -->

    <script type="text/javascript" src="biblemap/src/arc.js?version=20170813"></script>
    <script type="text/javascript" src="biblemap/src/common.js?version=20170903"></script>
    <script type="text/javascript" src="biblemap/lib/binaryajax.js?version=20170813"></script>
    <script type="text/javascript" src="biblemap/src/binarywrapper.js?version=20170813"></script>
    <script type="text/javascript" src="biblemap/src/GMDFileReader.js?version=20170901"></script>
    <script type="text/javascript" src="biblemap/src/propertyDB.js?version=20170813"></script>

    <script type="text/javascript" src="biblemap/src/makeHrefText.js?version=20180121"></script>
    <script type="text/javascript" src="biblemap/src/httpRequest.js?version=20180121"></script>
    <script type="text/javascript" src="biblemap/src/contentTextProc.js?version=20180210"></script>
    <script type="text/javascript" src="biblemap/src/routePlay.js?version=20171205"></script>
    <script type="text/javascript" src="biblemap/src/trajectoryData.js?version=20170901"></script>
    <script type="text/javascript" src="biblemap/src/httpRequest.js?version=20170829"></script>

    <script src="ol-cesium/Cesium/Cesium.js"></script>
    <script src="ol-cesium/olcesium.js"></script>

    <script type="text/javascript" src="biblemap/src/distanceMeasureControl.js?version=20170820"></script>
    <script type="text/javascript" src="biblemap/src/GMDFileDownload.js?version=20170906"></script>
    <script type="text/javascript" src="biblemap/src/openLayersControl.js?version=20180202"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <script type="text/javascript" src="biblemap/src/jQueryRotate.js"></script>
    <!-- <script type="text/javascript" src="biblemap/vendor/jquery-1.8.1.js"></script> -->
    <script type="text/javascript" src="biblemap/vendor/json2.js"></script>
    <script type="text/javascript" src="biblemap/src/jquery.collapse.js"></script>
    <script type="text/javascript" src="biblemap/src/jquery.collapse_storage.js"></script>
    <script type="text/javascript" src="biblemap/src/jquery.collapse_cookie_storage.js"></script>

    <script type="text/javascript" src="biblemap/src/windowAdjust.js?version=20180204"></script>


    <link rel="stylesheet" type="text/css" media="all" href="biblemap/css/autocomplete_style.css?version=20170911">
    <link rel="stylesheet" type="text/css" media="all" href="biblemap/css/popup.css?version=20170910">
    <link rel="stylesheet" type="text/css" media="all" href="biblemap/css/tabMenu.css?version=20170916">
    <link rel="stylesheet" type="text/css" media="all" href="biblemap/css/bubblePopup.css?version=20171210">
    <link rel="stylesheet" type="text/css" media="all" href="biblemap/css/poiTooltip.css?version=20171213">
    <!-- <link rel="stylesheet" type="text/css" media="all" href="biblemap/css/biblemap.css?version=version=20170916"> -->
    <!-- <script type="text/javascript" src="biblemap/js/jquery-1.9.1.min.js"></script> -->
    <script type="text/javascript" src="biblemap/js/jquery.autocomplete.min.js"></script>
    <script type="text/javascript" src="biblemap/src/searchBible.js?version=20170902"></script>


    <style type ="text/css">
        img {-ms-interpolation-mode:bicubic;}

        *{   margin: 0;padding: 0;

            -moz-box-sizing: border-box;            /*  마우스 드래그 방지   */
            box-sizing: border-box;
            -webkit-user-select : none;
            -moz-user-select : none;
            user-select: none;

        }

        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-size: 12px;
            color : rgb( 40, 40, 40 );
        }

        /* Let's get this party started */
        ::-webkit-scrollbar {
            width: 8px;
        }

        /* Track */
        ::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px rgba(240,240,240,0.3);
            -webkit-border-radius: 10px;
            border-radius: 10px;
        }

        /* Handle */
        ::-webkit-scrollbar-thumb {
            -webkit-border-radius: 10px;
            border-radius: 10px;
            background: rgba(240,240,240,0.8);
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5);
        }
        ::-webkit-scrollbar-thumb:window-inactive {
            background: rgba(240,240,240,0.8);
        }


        div > span {
            font-family: 'Nanum Gothic';
        }

        div > select {

            font-family: 'Nanum Gothic';
            font-size: 12px;
            padding-left: 5px;
            height:20px;



            /*background: url('biblemap/image/down_arrow.png') no-repeat 100% 50%; */  /* 네이티브 화살표를 커스텀 화살표로 대체 */

            /*border-radius: 0px; */ /* iOS 둥근모서리 제거 */
            /*-webkit-appearance: none; */ /* 네이티브 외형 감추기 */
            /*-moz-appearance: none;
            appearance: none;  */

            background-color: rgb(255,255, 255);
            border: 1px solid rgb(217, 217, 217);
        }

        .customSelect{
            background: url('biblemap/image/down_arrow.png') no-repeat 100% 50%; /* 네이티브 화살표를 커스텀 화살표로 대체 */
            background-color: rgb(255,255, 255);

            border-radius: 0px; /* iOS 둥근모서리 제거 */
            -webkit-appearance: none; /* 네이티브 외형 감추기 */
            -moz-appearance: none;
            appearance: none;
        }

        /* 화살표 없애기 for IE10, 11*/
        div > select::-ms-expand {
            display: none;
        }

        div > input {
            font-family: 'Nanum Gothic';
            font-size: 12px;

            -moz-user-select : text;
            -webkit-user-select : text;
            -ms-user-select : text;
            user-select : text;
            border: 1px solid rgb(217, 217, 217);
        }

        .wrapperDiv{
            /* overflow:hidden; */
            /* border:1px solid red; */
            height: 100%;
        }
        #sidebar{
            /* height: 100%; */
            width: 200px;
            float:left;
            border:1px solid grey;
            border-color: rgb( 210, 210, 210);
        }
        .mapview{
            /*width : 100%;
            height: 80%; */
            float: left;
            /* margin-right: -200px;
            padding-right: 200px; */
            background-color: #ffffff;
            /* border:1px solid grey; */
            border-bottom: 1px solid rgb(127, 127, 127);
        }

        #poiTextContent {
            letter-spacing:0px;
            line-height: 1.8em;
            font-family: 'Nanum Gothic', serif;
        }

        #footer{
            position: absolute;
            /* top: 65%;
            height: 34%; */
            left: 200px;
            /* width: 100%; */
            /* background-color: #D0E1EB;  */
            background-color: white;
            font-family: '새굴림';
            /* border:1px solid black;  */
        }

        #footerDummy{
            position: absolute;
            /* top: 65%;
            height: 34%; */
            left: 200px;
            /* width: 100%; */
            background-color: #D0E1EB;
        }



        .measure-distance {
            top: 65px;
            left: .5em;
        }
        .ol-touch .measure-distance {
            top: 120px;
        }

        .ol-touch .prevPoi {
            top: 80px;
        }

        text {
            font-family: 'Nanum Gothic', serif;
        }

        .button {
            /*vertical-align:center; */
            vertical-align: top;
            line-height: 1px;
            font-family: 'Nanum Gothic', serif;
            font-size: 11px;
            color: white;
            height: 20px;
            width: 30px;
            border:0;
            outline: 0;
            background-color: #38B7F5;
        }
        .dummy {

            width:200px;
            height: 15px;
            background-color:rgb( 199, 219, 252  );
        }

        .dummy2 {

            width:200px;
            height: 15px;
            /* background-color:rgb( 239, 244, 254  );  */
            background-color:rgb( 248, 248, 248  );
        }


    </style>

</head>

<body>


<div class="wrapperDiv">
    <div id="sidebar" style="position:absolute; background-color:rgb( 248, 248, 248  );">
        <div id="logo" style="height:32px; background-color:rgb( 59, 89, 153 );" onclick="showIntroBibleMap();"><img src="biblemap/image/biblemap_logo.png" style="width:27px; height:33px; vertical-align:middle" >
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span  style="font-size:11pt; font-weight:bold; color:white; text-align:center;  vertical-align:middle; font: 'Hanna', serif;" >성경지도</span></div>

        <div class="dummy2" style = "height: 8px;"></div>
        <div class="dummy2" style = "height:178px;">
            <div id ="bibleSearch" style="font-size:12px; height: 50px">
                <select id ="bibleTitle"  class="customSelect" name="bibleTitle" style="margin-left: 46px; width: 145px; height:21px; " ></select>
                <div style="height: 4px"></div>
                <input type="image" src="biblemap/image/left_arrow.png?version=20170905" style="position: absolute;  margin-left: 46px; width:18px; height:20px; vertical-align:middle" onclick="decreaseBibleChapter()">
                <input type="number" class="chapterNum" id ="bibleChapter" style="padding-left: 3px; margin-left: 66px; top: 50px;  width: 3em; height: 20px; font-size:12px;" value="1"> <span style="margin-left: 0px; font-size:12px;">장</span>
                <input type="image" src="biblemap/image/right_arrow.png?version=20170905" style="position: absolute;  margin-left: 2px;width:18px; height:20px; vertical-align:middle" onclick="increaseBibleChapter()">

                <input type="button" class="button" value="검색" style="position: absolute;  left: 138px; margin-left: 22px;" onclick="searchBibleChapter()">
            </div>

            <div name="searchWord" style="height:20px; width: 198px;">
                <!-- <img src="image/word_search2.png" style="width:20px; height:22px; vertical-align:middle" ><input type="text" id ="bibleWord" size="12" style="font-size:12px;" value="바울"><input type="button" value="검색" style="font-size:12px;" onclick="searchBibleWord()"> -->
                <span style="margin-left: 18px; font-size:12px;">단어</span>
                <input type="text" id ="bibleWord" size="12" style="position: absolute; padding-left: 5px; margin-left: 3px; left: 42px; width:112px; height:21px; font-size:12px;"  value="바울" onkeypress="if(event.keyCode==13) searchBibleWord();">
                <input type="image" src="biblemap/image/m_text_clear.png?version=20170916" style="position: absolute; top: 92px;  left: 136px;  width:19px; height:18px; vertical-align:bottom; border:none; "  onclick="clearSearchBibleWord()">
                <input type="button" class="button" value="검색" style="position: absolute; margin-left: 2px; left: 157px;" onclick="searchBibleWord()">
            </div>

            <div style="height: 14px; background: url(biblemap/image/horizon-line_2.png);"></div>

            <div class="content" style ="position: absolute; width:198px; top: 130px; height: 85px; background-color:#FFFFFF;">
                <span style="margin-left: 18px;  font-size:12px;">지명</span>
                <input type="text" name="currency" class="biginput" id="biblePlace" size="16"
                       style="position: absolute; left: 44px; top: -2px; padding-left: 3px; margin-left: 0px; width:112px; height:21px; font-size:12px; font:'Nanum Gothic'; " value="갈릴리 호수" onkeypress="if(event.keyCode==13) searchBiblePlace();">
                <input type="image" src="biblemap/image/m_text_clear.png?version=20170916" style="position: absolute; top: 0px;  left: 136px;  width:19px; height:18px; vertical-align:bottom; border:none; "  onclick="clearSearchPlaceWord()">
                <input type="button" class="button" value="검색" style="position: absolute; left: 157px; top:-2px; vertical-align:center; margin-left: 2px;" onclick="searchBiblePlace()">
                <div style="height: 4px"></div>
                <!-- <div id ="searchedPoiList" rows= "5" style="border:1px solid grey; margin-left:10px; height: 60px; width: 163px; font-size:13px ; clear: both;"></div>  -->
                <select id ="searchedPoiList" name="searchedPoiList" size='3' style="position: absolute; overflow:hidden; padding-left: 3px; margin-left:41px; left: 3px; top: 23px; width: 144px; height:52px; border: 1px solid #D9D9D9;  font-size:12px; font:'Nanum Gothic';" ></select>
            </div>

        </div>
        <!-- <div id="css3-animated-autoclose" data-collapse> -->
        <div id="accordion-example" data-collapse="accordion">
            <h3 class="open">시대별 경계 영역</h3>
            <div class="content" style ="background-color:#FFFFFF; height: 105px;">
                <span id ="range" style="margin-left: 20px; font-size:12px; vertical-align:middle;">현재의 국가</span>
                <div style="height: 8px"></div>
                <div name ="historyBar" style="margin-left:0px; width: 180px; height: 34px; border: 1px solid rgb(217, 217, 217);">
                    <input id="historyAdmin" type ="range" style = "margin-left: 10px; top: 5px; width:160px; height: 30px; font-size:12px; border: none;" min = "0" max = "8" value = "8" onchange="eventHistoryAdmin(this.value)" onclick="eventHistoryAdmin(this.value)" >
                    &nbsp;&nbsp;&nbsp;
                </div>
                <!--
                <div style="height: 8px"></div>
                <div id="historyAdminExplain" style ="overflow-y:scroll; margin-left: 0px; width : 180px; height: 160px; line-height: 1.6em; border: 1px solid #A7A4A4; font-family: 'Nanum Gothic';" >
                </div>
                -->
                <div style="height:5px;"></div>
                <div>
                    <input type="image" src="biblemap/image/show-info-icon.png?version=20170905" style="position:absolute; margin-left: 160px; width:20px; height:20px; vertical-align:middle" onclick="showHistoryAdmin()">
                </div>

            </div>
            <h3>주요 이동 경로</h3>
            <div class="content" style ="width:198px; background-color:#FFFFFF">
                <select id="movePath" class="customSelect" style="margin-left: 10px; width:160px; height:21px;" onchange="eventMovingPathChange(this.value)" ></select>
                <br>
                <div style="height: 10px"></div>
                <input type="image" src="biblemap/image/set-extent-icon.png?version=20170905" style="position: absolute; margin-left: 10px; width:20px; height:20px; vertical-align:middle" onclick="setExtentOfPath()">
                <select id="movingSpeed" class="customSelect" style="position: absolute; margin-left:40px; width:50px; height: 20px; font-size:12px;"  onchange="eventMovingSpeedChange(this.value)" ></select>
                <input type="image" src="biblemap/image/trajectory_play.jpg?version=20170905" style="position: absolute; margin-left:105px; width:20px; height:20px; vertical-align:middle" onclick="pathAction()">
                <input type="image" src="biblemap/image/trajectory_pause.png?version=2017905" style="position: absolute; margin-left:128px; width:20px; height:20px; vertical-align:middle" onclick="pathPause()">
                <input type="image" src="biblemap/image/trajectory_stop.jpg?version=2017905" style="position: absolute; margin-left:150px; width:20px; height:20px; vertical-align:middle" onclick="pathHide()">
                <br>
                <div style="height:15px;"></div>
                <!-- <div id="movePathExplain" style ="overflow-y:scroll; margin-left: 0px; width : 180px; height: 200px; line-height: 1.6em; border: 1px solid rgb(217,217,217); font-family: 'Nanum Gothic';" ></div> -->
                <input type="image" src="biblemap/image/show-info-icon.png?version=20170905" style="position: absolute; margin-left: 10px; width:20px; height:20px; vertical-align:middle" onclick="showPathExplain()">
                <select id ="pathPoiList" name="pathPoiList" size='10' style="overflow-y:scroll; margin-left:40px; width: 123px; height:170px; border: 1px solid #D9D9D9; " ></select>
                <div style="height: 5px"></div>
            </div>
            <h3>2D/3D 지도보기</h3>
            <div class="content" style ="background-color:#FFFFFF; height: 275px;">
                <div name ="historyBar" style="margin-left:0px; width: 180px; height: 110px; border: 1px solid rgb(217, 217, 217);">
                    <br>
                    <input type="radio" id="radioView2D"
                           name="radio2D3D" value="chkView2D" style="margin-left:10px;" checked="checked" >
                    <label for="radioView2D">2D View</label>
                    <br><br>
                    <input type="radio" id="radioView3D"
                           name="radio2D3D" value="chkView3D" style="margin-left:10px;">
                    <label for="radioView3D">3D View </label>
                    <br><br>
                    <input type="radio" id="radioViewAll"
                           name="radio2D3D" value="chkViewAll" style="margin-left:10px;">
                    <label for="radioViewAll">3D+2D View </label>
                    <br>
                    <br>
                </div>
            </div>


        </div>  <!--  <div id="css3-animated-autoclose" data-collapse>  -->

        <br>
        <br>

<!--
        <div>
            <br>
            &nbsp&nbsp<input id="createTrajectory" type ="button" value="생성" onclick="createTrajectory()" >
            &nbsp&nbsp<input id="delTrajectory" type ="button" value="삭제" onclick="delTrajectory()" >
            <br>
            <div id = "zoomLevel">ZoomLevel</div>
            <div id = "mousePosition">MousePos</div>
        </div>
-->
        <br>

        <div id ="dummy" class = "dummy" style="position: absolute; top:56px; width: 198px; height: 200px;">
            <span class="hana-font" style="margin-left: 40px; font-size:7pt; font-weight:bold; color:rgb( 59, 89, 153 ); text-align:center;  vertical-align:middle; font: 'Hanna', serif;" >www.biblemap.or.kr</span>
            <div id ="licenseNotice" style="left: 0px; top:0px; height: 17px; width:198px; background-color:rgb( 199, 219, 252  );" >
                <!-- <span style="color: rgb(255, 255, 255); font-size:11px; horizontal-align: center;" onclick="showLicenseNotice()" >   Notice</span> -->
                <a href="http://blog.naver.com/bible-map" target="_blank" style="text-decoration:none"><img src="biblemap/image/L_biblemap_logo.png" style="position: absolute; top: 17px; width:198px; height:182px; vertical-align:middle" ></a>
            </div>
        </div>

    </div>




</div>  <!-- Side bar div   -->

<div>
    <!-- <input type="text" name="currency" class="biginput" id="autocomplete" size="12" style="font-size:12px;"> -->
</div>
</div>

<div id="map" class="mapview" style="position:absolute;">
    <input id="view3DBtn" type="image" src="biblemap/image/view_3D_2.png?version=20171218"
           onmouseover="this.src='biblemap/image/view_3D_2_.png?version=20171218';"
           onmouseout="this.src='biblemap/image/view_3D_2.png?version=20171218';"
           style="position: absolute; border: none; width:35px; height:35px;" onclick="setViewMode3D()">
           <!-- style="border:1px solid #A0A0A0; position: absolute; width:35px; height:35px;" onclick="setViewMode3D()">  -->


    <!--
    <input id="zoomInBtn2D" type="image" src="biblemap/image/Zoom-In-icon.png?version=20171211"  style="border:none; position: absolute; width:28px; height: 28px;"
           onmouseover="this.src='biblemap/image/Zoom-In-icon_.png?version=20171208';"
           onmouseout="this.src='biblemap/image/Zoom-In-icon.png?version=20171211';"
           onclick="map2DZoomIn()">  -->

    <input id="zoomInBtn2D" type="image" src="biblemap/image/Zoom-In-icon.png?version=20171211"  style="border:none; position: absolute; width:29px; height: 29px;"
           onclick="map2DZoomIn()">

    <input id="zoomOutBtn2D" type="image" src="biblemap/image/Zoom-Out-icon.png?version=20171211" style="border:none;  position: absolute; width:29px; height: 29px;"
           onclick="map2DZoomOut()">

    <input id="measureBtn2D" type="image" src="biblemap/image/measure_btn.png?version=20171207" style="border: none; width:28px; height: 28px; position: absolute;" onclick="mesaureToggleBtn()">

</div>

<div id="map3D" class="mapview" style="position:absolute;">

    <input id="compassBtn" type="image" src="biblemap/image/compass2.png?version=20170930"
           onmouseover="this.src='biblemap/image/compass2_.png?version=20170930';"
           onmouseout="this.src='biblemap/image/compass2.png?version=20170930';"
           style="position: absolute; border:0; width: 60px; height: 60px;"  onclick="setRotateNorth()">
    <input id="turnLeftBtn" type="image" src="biblemap/image/turn_left_.png?version=20170905"
           onmouseover="this.src='biblemap/image/turn_left__.png?version=20170905';"
           onmouseout="this.src='biblemap/image/turn_left_.png?version=20170905';"
           style="position: absolute; width:18px; height:38px; border:0;" >
    <input id="turnUpBtn" type="image" src="biblemap/image/turn_up_.png?version=20170905"
           onmouseover="this.src='biblemap/image/turn_up__.png?version=20170905';"
           onmouseout="this.src='biblemap/image/turn_up_.png?version=20170905';"
           style="position: absolute; width:37px; height:16px; border:0;" >
    <input id="turnDownBtn" type="image" src="biblemap/image/turn_down_.png?version=20170905"
           onmouseover="this.src='biblemap/image/turn_down__.png?version=20170905';"
           onmouseout="this.src='biblemap/image/turn_down_.png?version=20170905';"
           style="position: absolute; width:37px; height:17px; border:0;" >
    <input id="turnRightBtn" type="image" src="biblemap/image/turn_right_.png?version=20170905"
           onmouseover="this.src='biblemap/image/turn_right__.png?version=20170905';"
           onmouseout="this.src='biblemap/image/turn_right_.png?version=20170905';"
           style="position: absolute; width:17px; height:36px; border:0;" >

    <input id="homeBtn" type="image" src="biblemap/image/home.png?version=20170930"
           onmouseover="this.src='biblemap/image/home2.png?version=20170930';"
           onmouseout="this.src='biblemap/image/home.png?version=20170930';"
           style="position: absolute; border:0; width:30px; height: 30px;" onclick="gotoHome()">

    <input id="view2DBtn" type="image" src="biblemap/image/view_2D_2.png?version=20171207" style="position: absolute; border: none; width: 35px; height:35px;"
           onmouseover="this.src='biblemap/image/view_2D_2_.png?version=20171207';"
           onmouseout="this.src='biblemap/image/view_2D_2.png?version=20171207';"
           onclick="setViewMode2DWithSync()">

    <input id="zoomInBtn3D" type="image" src="biblemap/image/Zoom-In-icon.png?version=20171209"  style="border: none; position: absolute; width:29px; height: 29px;"
           onclick="map3DZoomIn()">
    <input id="zoomOutBtn3D" type="image" src="biblemap/image/Zoom-Out-icon.png?version=20171209" style="border: none; position: absolute; width:29px; height: 29px;"
           onclick="map3DZoomOut()">

</div>

<!-- <div id="behindMap2D" class="mapview" style="position:absolute; display:none;"> -->
<div id="behindMap2D" class="mapview" style="position:absolute;">

</div>


<!-- <div id="footerDummy"></div> -->

<div id="footer">
    <ul id="tabsMenu" class="tabs">
        <li id="tab1Menu" class="active" rel="tab1">성경본문</span></li>
        <li id="tab2Menu" rel="tab2"><span style="font-color:white; ">단어검색</span></li>
        <li id="tab3Menu" rel="tab3">지명정보</li>
        <li id="tab4Menu" rel="tab4">기타정보</li>
    </ul>
    <div id ="tab_contain" class="tab_container"  >

        <div id = "tab1Title" class="divContent" style="padding-left: 20px; font-weight: bold; font-size:15px; top:-6px; height: 33px; overflow-x:hidden; color: rgb( 90, 90, 90 );" >
            <span id ="tabBibleBook" style="position: absolute; left: 15px; top: 0px; width:125px; font-size:15px; text-align:right;" ></span>
            <input id="tabDecBible" type="image" src="biblemap/image/left_arrow.png?version=20170907" style="position: absolute; left: 140px; width:22px; height:22px; vertical-align:middle; " onclick="tabDecreaseBibleChapterAndSearch()">
            <span id ="tabBibleChapter" style="position: absolute; left: 155px; width:70px; top: 0px; font-size:15px; text-align:center;">장</span>
            <input id="tabIncBible" type="image" src="biblemap/image/right_arrow.png?version=20170907" style="position: absolute; left: 220px; top: 0px; width:22px; height:22px; vertical-align:middle;" onclick="tabIncreaseBibleChapterAndSearch()">
        </div>

        <div id = "tab3Title" class="divContent" style="padding-left: 10px;  font-size: 16px; top:-6px; height: 35px; overflow-x:hidden; color: rgb( 90, 90, 90 ); " ></div>

        <div id="tab1" class="tab_content" style="padding-left: 10px; border-top:1px solid rgb(215, 215, 215);" >
            Waiting....
        </div>
        <div id="tab2" class="tab_content">
            검색결과가&nbsp;없습니다 <br> 성경의&nbsp;단어&nbsp;검색&nbsp;버튼을&nbsp;클릭해&nbsp;주세요
            <a href ="javascript:gotoSearchWord()" style="text-decoration:none; font-weight: bold; fong-size: 1.5em; color:rgb(0, 91, 227); text-align : left;">→ 바로가기 클릭!!</a><br>
        </div>
        <div id="tab3" class="tab_content"  style="padding-left: 5px; border-top:1px solid rgb(215, 215, 215);" oncontextmenu="return false" ondragstart="javascript:return false" onselectstart="javascript:return false" onkeydown="return false" >
            검색결과가&nbsp;없습니다 <br> 지도상의&nbsp;지명을&nbsp;클릭하고&nbsp;아이콘&nbsp;'i'를&nbsp;클릭해&nbsp;주세요
        </div>
        <div id="tab4" class="tab_content" oncontextmenu="return false" ondragstart="javascript:return false" onselectstart="javascript:return false" onkeydown="return false" >
            시대별&nbsp;경계&nbsp;영역&nbsp;또는&nbsp;주요&nbsp;이동&nbsp;경로&nbsp;메뉴에서&nbsp;아이콘&nbsp;'i'를&nbsp;클릭해&nbsp;주세요&nbsp
        </div>
    </div>
    <!-- .tab_container -->
</div>




<div>
    <img id="footerToggle" src="biblemap/image/hideBible.png?version=2017905" name="img" style="position:absolute; width:50px; height:12px;" onclick="toggleScrMap()">
</div>

<div id="bubblePopup" class="ol-popup" style="font-size:1.1em;">
    <a href="#" id="popup-closer" class="ol-popup-closer" ></a>
    <div style="height: 8px"></div>
    <div id="popup-content" class="ol-popup-content" style="text-align:center; font-size: 13px;"></div>
</div>

<div id="bubblePopup3D" class="ol-popup" style="font-size:1.1em;">
    <!--  <a href="#" id="popup-closer3D" class="ol-popup-closer3D" ></a>  -->
    <a href ="javascript:closePopup3D()" >
        <img  src="biblemap/image/bubble-close-icon.png" style="position:absolute; top:2px; right:8px; width:14px; height:14px; ">

    </a>
    <div style="height: 8px"></div>
    <div id="popup-content3D" class="ol-popup-content" style="text-align:center; font-size: 13px;"></div>
</div>


<div id="infoPopup" class="pop-layer" style = "width : 550px; height: 620px;" oncontextmenu="return false" ondragstart="javascript:return false" onselectstart="javascript:return false" onkeydown="return false" >
    <div class="pop-container" >
        <div>
            <span id ="noticeTitle" style="font-size:12pt; text-align:center;">
           </span>
        </div>
        <div id ="contentDiv" style = "overflow-y:scroll; line-height:24px; width: 510px; height: 500px;">
            <span id ="noticeContent" style="font-size:11pt; text-align:center;">
           </span>
        </div>
        <div class="btn-r">
            <a href="#" class="btn-layerClose">Close</a>
        </div>
    </div>
</div>


<div id="downloadingDiv" style ="position:absolute; ">
    <img src ="biblemap/image/downloading.gif?version=20170905">
</div>

<script>
    setDebug( false );

    if( isMobile() == true ){
        location.replace( 'biblemapMobile.html' );
    }

    var isReload = windowReloadByCurDate( 'biblemap3D-day');

    showDownloading();

    var isIE = true;

    var agt = navigator.userAgent.toLowerCase();
    if (agt.indexOf("chrome") != -1)
        isIE = false;

    window.tooltipID = 0;
    window.focusPoiObj = null;
    window.selectedPoiObj = null;
    window.zoom = 0;
    window.posX = 0;
    window.posY = 0;

    var map3DAddLayerTimer = -1;
    var setGroundLayerTimer;
    var tabMenu = createTabMenu();
    var curMapViewMode = 'chkView2D';   // "chkView2D" |  "chkView3D"  | "chkViewAll"

    $("#footerToggle").css( "z-index", "5000" );

    (function() {

        var flag = 0;

        var historyAdmin = document.getElementById("historyAdmin");
        if( historyAdmin.addEventListener ) {
            historyAdmin.addEventListener( "mousedown", function(){
                flag = 1;
            }, false );
            historyAdmin.addEventListener( "mouseup", function(){
                flag = 0;
            }, false );

            historyAdmin.addEventListener( "mousemove", function(){
                if( flag == 1 ){
                    currentHistoryAdminString( historyAdmin.value );
                }
            }, false);
        }


        ////////////////////////////////////////////////////////////////////////

        var turnLeftTimer;
        var turnRightTimer;

        var turnUpTimer;
        var turnDownTimer;

        var rotate = 0;
        var interval = 0.02;

        $('#turnLeftBtn').mousedown(function () {
            ConsoleLog("turnLeft Down!!!");
            turnLeftTimer = setInterval( turnLeftAct, 1);
        }).on('mouseup mouseleave', function () {
            ConsoleLog("turnLeft Up!!!");
            clearInterval( turnLeftTimer);
        });

        function turnLeftAct() {
            var view3D = map3D.view;
            rotate = view3D.getRotation();
            // ConsoleLog("turnLeft Event...... =>  " + rotate );
            rotate -= interval;
            view3D.setRotation( rotate );
        }



        $('#turnRightBtn').mousedown(function () {
            ConsoleLog("turnRight Down!!!");
            turnRightTimer = setInterval( turnRightAct, 1);
        }).on('mouseup mouseleave', function () {
            ConsoleLog("turnRight Up!!!");
            clearInterval( turnRightTimer);
        });

        function turnRightAct() {

            var view3D = map3D.view;
            rotate = view3D.getRotation();
            // ConsoleLog("turnRight Event...... =>  " + rotate );
            rotate += interval;
            view3D.setRotation( rotate );
        }


        $('#turnUpBtn').mousedown(function () {
            ConsoleLog("turnUp Down!!!");
            turnUpTimer = setInterval( turnUpAct, 1);
        }).on('mouseup mouseleave', function () {
            ConsoleLog("turnUp Up!!!");
            clearInterval( turnUpTimer);
        });

        function turnUpAct() {
            // ConsoleLog("turnUp Event...... ");
            map3D.view3DTilt( -0.002 );
        }

        $('#turnDownBtn').mousedown(function () {
            ConsoleLog("turnDown Down!!!");
            turnDownTimer = setInterval( turnDownAct, 1);
        }).on('mouseup mouseleave', function () {
            ConsoleLog("turnDown Up!!!");
            clearInterval( turnDownTimer);
        });

        function turnDownAct() {
            // ConsoleLog("turnDown Event...... ");
            map3D.view3DTilt( 0.002 );
        }

    }());


    function startMap3DAddLayerWithTimer() {
        map3DAddLayerTimer = setInterval(addLayerTo3DMapOneByOne, 500);
    }


    function addLayerTo3DMapOneByOne(){
        if( map3D == null )
            return;

        setCursorByID('map','wait');
        setCursorByID('map3D','wait');

        var ret = map3D.memLayerAddToMapOneByOne();
        if( ret == true ){
            sync2DMapTo3DMap();
            map3D.setGroundWholeLayer();
            waitOver();
            clearInterval( map3DAddLayerTimer );
            map3DAddLayerTimer = null;
        }
        else{
            ConsoleLog("addMap3DAddLayerWithTimer ..........");
        }
    }


    /*
    function setGroundPopup(){

        if( curMapViewMode != 'chkView2D' ) {
            // if( map3D.setGroundPopup() == true )
            //  clearInterval( setGroundLayerTimer );
            popup3DSelfGroundPosition();
        }
    }
    */



    function setCursorByID( id, cursorStyle ) {
        var elem;
        if (document.getElementById ){
            elem = document.getElementById(id);
            if(elem) {
                if (elem.style)
                    elem.style.cursor = cursorStyle;
            }
        }
    }

    var scaleBtnFunc2D = null;
    var scaleBtnFunc3D = null;

    $(document).ready(function(){

        scaleBtnFunc2D = createScaleBtns( "map", 4, 15 );
        scaleBtnFunc3D = createScaleBtns( "map3D", 4, 18 );
        //scaleBtnFunc3D = createScaleBtns( "map3D", 4, 16 );

        tabMenu.selectTab( 'tab1Menu');
        var oldValue = 'chkView2D';

        $("input[name=radio2D3D]").change(function() {
            var radioValue = $(this).val();

            curMapViewMode = radioValue;

            if (radioValue == "chkView2D") {
                if( oldValue != "chkViewAll" ) {
                    sync3DMapTo2DMap();
                }
            }
            if (radioValue == "chkView3D") {
                if( oldValue != "chkViewAll" ) {
                    sync2DMapTo3DMap();
                }
            }
            if( radioValue == "chkViewAll"){
                if( oldValue == 'chkView2D'){
                    sync2DMapTo3DMap();
                }
                if( oldValue == 'chkView3D'){
                    sync3DMapTo2DMap();
                }
            }

            oldValue = radioValue;
            adjustScrDiv.view2D3DCtrl( radioValue );

        });

    });


    function setRotateNorth() {
       map3D.view.animate({
            rotation: 0,
            duration : 500
        });
    };


    function createTrajectory() {

        bibleMapManager.addTrajectoryInteraction(function (vertices) {
            console.log("------------------------");
            console.log("[");
            for (var idx = 0; idx < vertices.length; idx++) {
                var pos = vertices[idx];
                console.log( "[" + pos + "],");
            }
            console.log("]");
            console.log("------------------------");
        });
    }

    function delTrajectory(){
        bibleMapManager.removeTrajectoryInteraction();
    }


    var dvBibleTitle = document.getElementById('bibleTitle');
    var dvBibleChapter = document.getElementById('bibleChapter');
    var beforeChapterSearchParam = { type: "Args",     // book, chapter, paragraph 등으로 구성된 검색
        option: { "title": "",
            "chapter" : ""
        }
    };

    dvBibleTitle.addEventListener("change", function(e){
        dvBibleChapter.value = "1";
        searchBibleChapter();
    });


    $('.chapterNum').bind('keyup mouseup', function(){
        searchBibleChapter();
    } );

    var dvBibleWord = document.getElementById("bibleWord");

    var dvBiblePlace = document.getElementById("biblePlace");

    /*
     dvBiblePlace.addEventListener("change", function(e){
     searchBiblePlace();
     });
     */

    //////////////////////////////////
    $( '#infoPopup' ).css( "z-index", 6000 );
    //////////////////////////////////


    var dvPopupContainer = document.getElementById('bubblePopup');
    dvPopupContainer.setAttribute("id", "popupContainer" );
    $( '#popupContainer' ).css( "z-index", 2100 );


    var dvPopupContent = document.getElementById('popup-content');
    var dvPopupCloser = document.getElementById('popup-closer');

    function createOverlay( divID ){    // container
        var overlay = new ol.Overlay( ({
            element: divID,
            autoPan: true,
            autoPanAnimation: {
                duration: 250
            }
        }));
        return overlay;
    }



    var overlay = createOverlay( dvPopupContainer );

    var popup2D = {
        name : "2D",
        overlay : overlay,
        content : dvPopupContent,
        closer : dvPopupCloser
    };

    popup2D.closer.onclick = function() {
        popup2D.overlay.setPosition(undefined);
        popup2D.closer.blur();
        popup2D.content.innerHTML = "";

        return false;
    };


    var dvPopupContent3D = document.getElementById('popup-content3D');

    dvPopupContainer.setAttribute("id", "popupContainer3D" );
    $( '#popupContainer3D' ).css( "z-index", 2200 );

    var overlay3D = new ol.Overlay({
        element: document.getElementById('bubblePopup3D')
    });

    var popup3D = {
        name : "3D",
        position : [],
        overlay : overlay3D,    // dvPopupContainer
        content : dvPopupContent3D
        //  closer : dvPopupCloser3D
    };


    overlay3D.setGroundPosition = function( position ){
        var feature = new ol.Feature({
            geometry: new ol.geom.Point([position[0], position[1]] )
        });

        var mapCoord = map3D.getMapCoordFromFeature( feature );

        this.setPosition( mapCoord );
        popup3D.position = mapCoord;
        feature = null;
    };

    popup3DSelfGroundPosition = function(){
        var pos = overlay3D.getPosition();
        if( pos != undefined )
            overlay3D.setGroundPosition( popup3D.position );
    };


    function closePopup3D(){
        popup3D.overlay.setPosition(undefined);
        // popup3D.closer.blur();
        popup3D.content.innerHTML = "";
    }

    function closePopup2D(){
        popup2D.closer.onclick();
    }


    function showPopup( position, content ){

        popup2D.content.innerHTML = content;
        popup2D.overlay.setPosition( position );
        popup3D.content.innerHTML = content;
        popup3D.overlay.setGroundPosition( position );

    }

    function showTooltip( poiID, label, position ){
        poiTooltip2D.removeAndCreate( poiID, label, position, false );
        poiTooltip3D.removeAndCreate( poiID, label, position, false );
        poiTooltip3D.setGroundPosition( position );
    }

    function closeTooltip(){
        poiTooltip2D.allRemove();
        poiTooltip3D.allRemove();
    }

    setCursorByID('map','wait');
    setCursorByID('map3D','wait');

    var bibleChapterList = new BibleChapterList();

    bibleChapterList.setCallback( function(){
            downloadGeometries();

            for( var order = 1; order <= bibleChapterList.getCount(); order ++  ) {
                var chapter = document.createElement("option");
                var obj =  bibleChapterList.getChapterByNumber( order );
                chapter.text = obj.title;
                chapter.value = obj.bookNumber;
                dvBibleTitle.appendChild( chapter );
            }

            getSearchWordsFromStorage();

            getLocationFromStorage();
            if( window.posX > 0 && window.posY > 0)
                moveTo( bibleMap.getView(), [window.posX, window.posY], window.zoom );

    });

    var bibleMapManager = createMapManager( popup2D.overlay, 'map' );
    var map3D = init3dMap(  popup3D.overlay );

    function setGroundMap3D() {

        if( curMapViewMode != 'chkView3D' )
            return;

        poiTooltip3D.setGroundPosition();
        map3D.setGroundWholeLayer();
    }

    setGroundLayerTimer = setInterval( setGroundMap3D, 3000 );

    var trajectoryData = new TrajectoryData();

    function downloadTrajectoryData( callback ) {

        var callbackFunc = callback;

        trajectoryData.requestMovePath( function( resObj ){

            eventMovingPathChange(0);     //

            var selPath = document.getElementById('movePath');
            var count = trajectoryData.getCount();
            for( var idx = 0; idx < count; idx ++  ) {
                var path = document.createElement("option");
                var obj = trajectoryData.getTrajectoryByValue(idx);
                // path.text = obj.name;
                path.text = obj.title;
                path.value = obj.value;
                selPath.appendChild( path );
            }
            if( callbackFunc ) {
                callbackFunc();
            }

        } );
    }

    function beforePoi(){
        var isUpdate = false;
        var poiObj = layerManager.historyPrevPoi();
        if( poiObj != null ) {
            if( window.focusPoiObj == null )
                isUpdate = true;
            else{
                if( window.focusPoiObj.id != poiObj.id ){
                 isUpdate = true;
                }
            }

            if( isUpdate == true ) {
                window.focusPoiObj = poiObj;
                moveToPlaceByPoiObj(poiObj);
                if (window.focusPoiObj != poiObj) {
                    // requestPoiContentAndShow( poiObj, poiTooltip2D, poiTooltip3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
                }
                poiContentsToTab_(poiObj);
                $("#tab3").scrollTop(0);
            }
        }
    }

    function afterPoi(){
        var isUpdate = false;
        var poiObj = layerManager.historyNextPoi();
        if( poiObj != null ) {
            if( window.focusPoiObj == null )
                isUpdate = true;
            else{
                if( window.focusPoiObj.id != poiObj.id ){
                    isUpdate = true;
                }
            }

            if( isUpdate == true ) {
                window.focusPoiObj = poiObj;
                moveToPlaceByPoiObj(poiObj);
                if (window.focusPoiObj != poiObj) {
                    // requestPoiContentAndShow( poiObj, poiTooltip2D, poiTooltip3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
                }
                poiContentsToTab_(poiObj);
                $("#tab3").scrollTop(0);
            }
        }

    }


    var layerManager = bibleMapManager.getLayerManager();
    var bibleMap = bibleMapManager.getMap();


    // var poiTooltip2D = new Tooltip( "2D", bibleMap, 'poiTooltip poiTooltip-static', 2000 );
    // var poiTooltip3D = new Tooltip( "3D", map3D.map, 'poiTooltip poiTooltip-static', 1000 );
    var poiTooltip2D = new Tooltip( "2D", bibleMap, 'poiTooltip poiTooltip-static' );
    var poiTooltip3D = new Tooltip(  "3D", map3D.map, 'poiTooltip poiTooltip-static' );


    var measureDistance = new DistanceMeasureControl( bibleMapManager );


    var selSpeed = document.getElementById('movingSpeed');
    var baseSpeed = 0.0;
    for( var idx = 0; idx < 4; idx ++ ){
        var speed = document.createElement( "option");
        speed.text = (idx + 1) + 'x';
        speed.value = baseSpeed;
        baseSpeed += 0.04;
        selSpeed.appendChild( speed );
    }



    ///////////////////////////////////////
    function sync2DMapTo3DMap() {
        // bibleMap.updateSize();

        var zoom = bibleMapManager.getView().getZoom();
        /*
        if( typeof( zoom ) != 'undefined') {
        }else{
            zoom = 14;
        }
        */

        var center = bibleMapManager.getView().getCenter();

        map3D.view.setZoom(zoom + 1);
        map3D.view.setCenter(center);

        map3D.map.updateSize();
    }

    function setMap3DPosByPos( position ){

        var zoom = bibleMapManager.getView().getZoom();
        if( typeof( zoom ) != 'undefined') {
        }else{
            zoom = 14;
        }

        map3D.view.setZoom(zoom + 1);
        map3D.view.setCenter( position );
    }


    function mesaureToggleBtn() {

        var img1 = "biblemap/image/measure_btn.png?version=20171207";
        var img2 = "biblemap/image/measure_btn_toggle.png";

        var measureBtn = document.getElementById("measureBtn2D");

        var measureMode = measureDistance.toggleMeasureDistance();

        if( measureMode == true )
            measureBtn.src = img2;
        else
            measureBtn.src = img1;
    }


    function sync3DMapTo2DMap() {
        // bibleMap.updateSize();

        var zoom = map3D.view.getZoom();
        if( typeof( zoom ) != 'undefined' ) {
        }else{
            zoom = 16;
        }

        var center = map3D.view.getCenter();

        bibleMapManager.getView().setZoom(zoom - 1);
        bibleMapManager.getView().setCenter(center);

        bibleMap.updateSize();
    }


    function waitOver(){

        hideDownloading();
        setCursorByID('map','default');
        setCursorByID('map3D','default');

        /*
        var delayTime = 1000;
        if( isIE == true ){
            delayTime = 3000;
        }

        timeout = setTimeout(function(){
            hideDownloading();
            setCursorByID('map','default');
            setCursorByID('map3D','default');
            clearTimeout(timeout);
        }, delayTime );
        */

    }


    function completeDownloadPolygons() {

        changeHistoryAdmin( historyAdmin.value );
        writeInfoTabHistoryAdmin();

        var strPoi = getFocusPoiFromStorage();
        if (strPoi != null) {
            window.focusPoiObj = layerManager.getPoiObjByPlaceAndTitle(strPoi.place, strPoi.title);
            // bibleMapManager.createPoiIcon( window.focusPoiObj );        // focus POI Icon 만들기
            bibleMapManager.setIconPosByPoi(window.focusPoiObj);        // focus POI Icon 만들기
            map3D.setIconPosByPoi(window.focusPoiObj);        // focus POI Icon 만들기

            layerManager.historyInsertPoi(window.focusPoiObj);

            downloadTrajectoryData(function () {
                requestPoiContentAndShow(window.focusPoiObj, poiTooltip2D, poiTooltip3D);
                sync2DMapTo3DMap();
            });     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
        }
        else {
            downloadTrajectoryData(function () {
                sync2DMapTo3DMap();
            });
        }
    }


    function downloadPolygons( ){

         startMap3DAddLayerWithTimer();

        layerManager.layerContainer.totalCount += bibleMapPolygonLayers.length;
        for( var pid in bibleMapPolygonLayers ) {
            var layer = bibleMapPolygonLayers[ pid ];
            new GMDFileDownload( bibleMap, null, layer.url, layer.order, layer.style, layerManager, function(){
                completeDownloadPolygons();
                // map3D.view3DTilt(1.1);
            } );
        }
    }


    function completePoiDownload(){
        $("#bibleWord").focus();
        layerManager.sortPoiWords();
        sync2DMapTo3DMap();
        initTextAutoComplete();

        searchBibleChapter( function(){
            downloadPolygons( );
        });
    }


    function downloadGeometries(){

        sync2DMapTo3DMap();

        layerManager.layerContainer.totalCount = bibleMapPointLayers.length;

        for( var idx in bibleMapPointLayers ){
            var layer = bibleMapPointLayers[idx];
            new GMDFileDownload( bibleMap, map3D, layer.url, layer.order, layer.style, layerManager, completePoiDownload );
        }
    };



    ///////////////////////////////////////////////////////////////

    var routeMove;
    var oldMovePath = -1;

    function eventMovingPathChange( value){

        var trajectory = trajectoryData.getTrajectoryByValue( value );
        if( trajectory == null )
            return;

        //   document.getElementById("movePathExplain").innerHTML = trajectory.text;
        //   $("#movePathExplain").scrollTop(0);

        //    $('#pathPoiList').empty();
    }


    function showPathExplain(){

        writeInfoTabPathExplain();
        adjustScrDiv.setIsFullScr("false");

        $("#tab4").scrollTop(0);
        tabMenu.selectTab('tab4Menu');

    }

    function writeInfoTabPathExplain(){
        var infoTab = document.getElementById( 'tab4' );

        var val = document.getElementById("movePath").value;
        var obj = trajectoryData.getTrajectoryByValue( val );
        var strConvText;

        infoTab.innerHTML = "<strong><font >" + '[ ' + obj.title + ' ]' + "</font></strong>" +'<br>';

        var infoObj = { // title : poiText,
            content : obj.text
        };

        if( obj.text ) {
            strConvText = makeStrongInText( layerManager, "abc", infoObj );
        }

        infoTab.innerHTML += strConvText;
    }

    function eventMovingSpeedChange( value ){

        ConsoleLog( "EventMovingSpeed :" + value );

        if( routeMove)
            routeMove.adjustMovingSpeed( value );
    }


    function setExtentOfPath() {

        // dvPopupCloser.onclick();
        popup2D.closer.onclick();
        // adjustScrDiv.setIsFullScr("true");
        var movePath = $("#movePath").val();
        var index = Number(movePath);
        var extent = trajectoryData.getExtent(index);
        var view = bibleMap.getView();
        view.fit(extent, bibleMap.getSize());

    }


    // "chkView2D"
    function setViewMode( viewMode ) {
        adjustScrDiv.view2D3DCtrl(viewMode );
        curMapViewMode = viewMode;   // "chkView2D" |  "chkView3D"  | "chkViewAll"
    }


    function setViewMode2DWithSync(){

        setViewMode2D();

        sync3DMapTo2DMap();
    }

    function setViewMode2D(){
        closePopup3D();

        setViewMode( 'chkView2D' );
        $('input:radio[name="radio2D3D"][value=chkView2D]').prop("checked", true);
    }


    function setViewMode3D(){
        if( map3DAddLayerTimer == -1 )
            return;

        closePopup2D();

        setViewMode( 'chkView3D' );
        $('input:radio[name="radio2D3D"][value=chkView3D]').prop("checked", true);
        sync2DMapTo3DMap();
    }


    function pathAction( ) {
        closeTooltip();
        closePopup3D();
        closePopup2D();

        // showPathExplain();
        adjustScrDiv.setIsFullScr("true");

        measureDistance.removeMeasureDraw();

        if( routeMove ){
            routeMove.stop();
        }

        var speed = $("#movingSpeed").val();

        var movePath = $( "#movePath" ).val();
        var index = Number( movePath);

        var trajectory = trajectoryData.getTrajectoryByValue( index );
        if( trajectory == null )
            return;

        setViewMode2D();

        var pathArrowLayer = CreatePathArrowLayer( trajectory.data, false );
        map3D.addPathLayer( pathArrowLayer );

        function newRouteMoveProcess(){
            routeMove = new RouteMoveProcess(bibleMap, trajectory, layerManager.getPoiObjectArray(), function( popupPoiArray ){
                fillPathPoiList( popupPoiArray );
                map3D.createLandMarkOfPath( popupPoiArray );
            });

            routeMove.adjustMovingSpeed( speed );

            var extent = trajectoryData.getExtent(index);

            var view = bibleMap.getView();
            view.fit(extent, bibleMap.getSize());

            routeMove.play();
            oldMovePath = movePath;
        }


        if( oldMovePath != movePath ) {
            newRouteMoveProcess();
        }
        else{
            if( routeMove ) {
                routeMove.pause(false);
                routeMove.play();
            }
            else{
                newRouteMoveProcess();
            }
        }

    }

    function pathPause(){
        if( routeMove ){
            routeMove.pause( true );
        }
    }

    function pathHide(){

        if( routeMove ){
            routeMove.stop();
        }

        map3D.removePathLayer( );

        routeMove = null;
    }


    bibleMapManager.mapEventPrecompose( function(evt){
        var zoom = bibleMapManager.getView().getZoom();
        // $("#zoomLevel").html("zoom level : " + zoom ); // + zoom;

        /*
        var centerPos = bibleMapManager.getView().getCenter();

        window.zoom = zoom;
        window.posX = centerPos[0];
        window.posY = centerPos[1];
        */

        // scaleBtnEventTimer2D = setInterval( scaleBtnEvent2D, 1);
        scaleBtnFunc2D( zoom );

        if( routeMove)
            routeMove.updateMovingSpeed( zoom );

    });


    map3D.mapEventPrecompose( function(evt){

        var radian = map3D.view.getRotation();
        var mapAngle = radian * (180/ Math.PI);
        if( mapAngle < 0 ){
            mapAngle = 360 + mapAngle;
        }

        mapAngle = Math.floor( mapAngle );
        var nAngle = parseInt( mapAngle );
        $("#compassBtn").rotate( nAngle);


        var zoom = map3D.view.getZoom();
        scaleBtnFunc3D( zoom );

    });




    bibleMapManager.clickEvent( function(evt){
        var clickedPos = evt.coordinate;
        // $("#mousePosition").html( "Pos X: " + clickedPos[0] + ", Y:" + clickedPos[1] ); // + zoom;

        // poiTooltip2D.allRemove();
        closeTooltip();

        /*
        var tempTooltip1 = new Tooltip( "2D", bibleMap, 'poiTooltip poiTooltip-static', 1000 );
        tempTooltip1.create( 1, "temp1", clickedPos, "#ffcc33" );

        var tempTooltip2 = new Tooltip( "2D", bibleMap, 'pathTooltip pathTooltip-static', 1 );
        tempTooltip2.create( 2, "temp2", [ clickedPos[0]+1000, clickedPos[1] ] , "#ffcc33" );
        */


        ConsoleLog( "Map2D Click!!!! ");

    });


    map3D.clickEvent( function(evt){
        var clickedPos = evt.coordinate;

        // ConsoleLog( "Map3D Click!!!! ");
        closeTooltip();
    });

    map3D.map3DClick( function( mapX, mapY ){

        ConsoleLog( "Map3D Click!!!!  mapX : " + mapX + ", mapY : " + mapY );

        var poiObj = findPoiByCoord ( map3D.view.getZoom(), mapX, mapY, layerManager.getPoiObjectArray() );
        if( poiObj ){
            var poiObj = layerManager.getPoiObjById( poiObj.id );

            poiObj.feature.getGeometry().set('altitudeMode', 'clampToGround');

            // requestPoiContentAndShow( poiObj, popup2D, popup3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
            requestPoiContentAndShow( poiObj, poiTooltip2D, poiTooltip3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색

            var view2D3D = adjustScrDiv.getCurrent2D3DString();
            if( view2D3D == 'chkViewAll' || view2D3D == 'chkView2D') {
                var curZoom = bibleMap.getView().getZoom();
                var view = bibleMap.getView();
                moveTo( view, [ poiObj.x, poiObj.y ], curZoom );
            }


        }else{
            closeTooltip();
        }

    });

    map3D.mapWheel( function(){

    } );


    bibleMapManager.singleClickEvent( function(evt){
    });

    bibleMapManager.selectFeatureEvent( function(e) {
        var selLen = e.selected.length;
        if (selLen < 1)
            return;

        beforeChapterSearchParam = { type: "Args",     // book, chapter, paragraph 등으로 구성된 검색
            option: { "title": "",
                "chapter" : ""
            }
        };


        ConsoleLog( "Zoom : "+ window.zoom + ", posX : " + window.posX + ", posY : " + window.posY );

        var feature = e.selected[0];    // 첫번째 걸린 것만 가져오기로 하자

        var layer = feature.getLayer(bibleMap);
        var id = layer.get("id");
        var pos = null;

        var posName = feature.get("label");     //  OpenLayersControl.js 내에  createTextStyleOfFeature 함수에서  text: feature.get('label') 으로 설정되어 있음
        var poiID = feature.get("id");     //  OpenLayersControl.js 내에  createTextStyleOfFeature 함수에서  text: feature.get('label') 으로 설정되어 있음

        var zoom3D = map3D.view.getZoom();
        if( window.focusPoiObj !== null && window.focusPoiObj.id == poiID ){
            tabMenu.selectTab('tab3Menu');
        }

        if (posName == null) {      // polygon 레이어를 클릭했을 경우
            posName = feature.get("name");      // History admin polygon에는 name과 name2 필드가 존재함
            var nationName = posName;
            if (posName == null)
                return;
            if (id < 5) {          // 전세계 폴리곤 경계라면...
                posName = "<strong>현재 국가</strong><br>" + "&nbsp;" + posName;

                // showPopup( bibleMapManager.getClickecPos(), posName );
                showTooltip( nationName, posName, bibleMapManager.getClickecPos() );
            } else {    // 나머지 폴리곤에 정의된 "name" 필드로 검색하도록 한다

                var poiArray = layerManager.getPoiObjArrayFromDictionary( posName );
                if( poiArray.length < 2){
                    var poiObj = poiArray[ 0];

                    /*
                    if( curMapViewMode == 'chkView2D' ){
                        setMap3DPosByPos( [poiObj.x, poiObj.y] );
                    }*/

                    requestPoiContentAndShow( poiObj, poiTooltip2D, poiTooltip3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
                    moveToMap3DWithCheck3DShow( poiObj.x, poiObj.y );
                }
            }
        } else {        //  poi Layer를 선택했을 경우
            if (id < 5) {          // 전세계 폴리곤 경계라면...
                var nationName = posName;
                posName = "<strong>현재 국가</strong><br>" + "&nbsp;" + posName;
                // showPopup( bibleMapManager.getClickecPos(), posName );
                if( curMapViewMode == 'chkView2D' ){
                    setMap3DPosByPos( bibleMapManager.getClickecPos() );
                }
                showTooltip( nationName, posName, bibleMapManager.getClickecPos() );
                moveToMap3DWithCheck3DShow( bibleMapManager.getClickecPos()[0], bibleMapManager.getClickecPos()[1] );
            } else {    // 나머지 폴리곤에 정의된 "name" 필드로 검색하도록 한다

                var poiObj = layerManager.getPoiObjById( poiID );
                /*
                if( curMapViewMode == 'chkView2D' ){
                    setMap3DPosByPos( [poiObj.x, poiObj.y] );
                }
                */

                requestPoiContentAndShow( poiObj, poiTooltip2D, poiTooltip3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
                moveToMap3DWithCheck3DShow( poiObj.x, poiObj.y );
            }
        }

    });


    function gotoHome( ){
        closePopup2D();
        closePopup3D();
        gotoHome_( bibleMapManager.getView(), map3D.view );
        setRotateNorth();

        var pivot = { x:4444090.267634998,
            y: 3058088.2612847225,
            z: 3391385.4960272433 };
        var axis = {  x: -0.5668782255161677,
            y: 0.8238016007726867,
            z: -1.9428902930940  };


        // map3D.view3DTilt_( 1.1, pivot );

        // map3D.view3DTilt( -1.1 );
    }

    function moveToMap3DWithCheck3DShow( posX, posY ){
        var zoom3D = map3D.view.getZoom();
        var view2D3D = adjustScrDiv.getCurrent2D3DString();
        if( view2D3D == 'chkViewAll' || view2D3D == 'chkView3D'){
            moveTo( map3D.view, [posX, posY ], zoom3D );
        }
    }



    map3D.selectFeatureEvent( function(e) {
        var selLen = e.selected.length;
        if (selLen < 1)
            return;

        ConsoleLog( "map3D Clieck Event!!!");

    });


    function searchBiblePlace(){
        if( dvBiblePlace.value == "" ){
            return;
        }

        dvBiblePlace.value = removeSpaceInWord( dvBiblePlace.value );

        saveSearchWordsToStorage();

        var selSearchedPoiList = document.getElementById( "searchedPoiList" );

        $('#searchedPoiList').empty();

        var poiArray = layerManager.getPoiObjArrayFromDictionary( dvBiblePlace.value );
        for( var idx in poiArray ){
            ConsoleLog( "Find POI : " + poiArray[idx].biblePlace + ", title : " +  poiArray[idx].title );

            var poiItem = document.createElement("option");
            if( poiArray[idx].title != "" )
                poiItem.text = poiArray[idx].title;
            else
                poiItem.text = poiArray[idx].biblePlace;
            poiItem.value = poiArray[idx].id;
            selSearchedPoiList.appendChild( poiItem );
        }

        var poiObj = null;

        if( poiArray.length == 1 ){
            poiObj = poiArray[0];
            moveToPlaceByPoiID( poiObj.id );
            // deepMoveToPlaceByPoiObj( poiObj );
        }
    }


    $("#searchedPoiList").click( function(){
        moveToPlaceSelPoiTitle( "#searchedPoiList" )
    });


    function fillPathPoiList( pathPoiArray ){
        var selSearchedPoiList = document.getElementById( "pathPoiList" );

        $('#pathPoiList').empty();

        for( var idx in pathPoiArray ){
            ConsoleLog( "path POI : " + pathPoiArray[idx].biblePlace + ", title : " +  pathPoiArray[idx].title );

            var poiItem = document.createElement("option");
            if( pathPoiArray[idx].title != "" )
                poiItem.text = pathPoiArray[idx].title;
            else
                poiItem.text = pathPoiArray[idx].biblePlace;
            poiItem.value = pathPoiArray[idx].id;
            selSearchedPoiList.appendChild( poiItem );
        }

        $('#pathPoiList').scrollTop(0);
    }

    $("#pathPoiList").click( function(){
        moveToPlaceSelPoiTitle( "#pathPoiList" )
    });



    function moveToPlaceSelPoiTitle( selectId ){

        var selPoiId = $( selectId ).val();

        moveToPlaceByPoiID( selPoiId );
    }



    function moveToPlaceByPoiID( poiID ){
        if( poiID == null )
            return;

        var poiObj = layerManager.getPoiObjById( poiID );
        moveToPlaceByPoiObj( poiObj );
    }

    function map3DZoomIn(){
        map3D.zoomIn();
    }

    function map3DZoomOut(){
        map3D.zoomOut();
    }

    function map2DZoomIn(){
        bibleMapManager.zoomIn();
    }

    function map2DZoomOut(){
        bibleMapManager.zoomOut();
    }


    function move2DMap( moveDistance, extentLength, view, curZoom, poiObj ){

        var mapBaseExtent = bibleMapManager.getMapBaseExtent();

        var mapExtent = view.calculateExtent(bibleMap.getSize());
        var curZoom = view.getZoom();
        var mapExtentDistance = getDistance( mapExtent[0],mapExtent[1], mapExtent[2], mapExtent[3] );
        var mapCenter =  view.getCenter();
        var poiDistance = getDistance( mapCenter[0], mapCenter[1], poiObj.x, poiObj.y );
        var isFar = false;
        if( mapExtentDistance < poiDistance )
            isFar = true;

        var tolerance = 0.0;
        var poiZoomIn = poiObj.zoomIn;

        if( IsIntersectExtent( mapBaseExtent, poiObj.x, poiObj.y ) == true) {    // 기본 지도 영역 이내에 있으면
            if (poiZoomIn < 6) {
                poiZoomIn = 7.8;
            } else {
                poiZoomIn -= 1;
            }

            // if( curZoom < poiZoomIn ){
            if (IsIntersectExtent(mapExtent, poiObj.x, poiObj.y) == true) {
                poiZoomIn = curZoom;
            } else {
                tolerance = Math.abs(curZoom - poiZoomIn);
                if (tolerance > 2) {
                    poiZoomIn = ( curZoom + poiZoomIn ) / 2.0;
                } else {
                    poiZoomIn = curZoom;
                }
            }
            if( tolerance > 2 ){
                flyTo(view, [poiObj.x, poiObj.y], poiZoomIn, function (complete) {
                    if (complete == true) {
                    }
                });
            }
            else
            {
                moveTo(view, [poiObj.x, poiObj.y], poiZoomIn);
            }

            saveLocationToStorage( poiZoomIn, poiObj.x, poiObj.y );

        }else{
            if( poiZoomIn < 6 )
                poiZoomIn = 6.5;
            else
                poiZoomIn -= 1;

            if( isFar == true ) {
                saveLocationToStorage( poiZoomIn, poiObj.x, poiObj.y );
                flyTo(view, [poiObj.x, poiObj.y], poiZoomIn, function (complete) {
                    if (complete == true) {
                    }
                });
            }else{
                if(IsIntersectExtent( mapExtent, poiObj.x, poiObj.y ) == true) {    // 현재 지도 영역 이내에 있으면
                    saveLocationToStorage( curZoom, poiObj.x, poiObj.y );
                    moveTo(view, [poiObj.x, poiObj.y], curZoom );
                }
                else {
                    saveLocationToStorage( poiZoomIn, poiObj.x, poiObj.y );
                    moveTo(view, [poiObj.x, poiObj.y], poiZoomIn);
                }
            }
        }
    };


    function move3DMap( view, poiObj ){

        var mapBaseExtent = bibleMapManager.getMapBaseExtent();

        var mapExtent = view.calculateExtent(map3D.map.getSize());
        // var mapExtent = bibleMap.getView().calculateExtent(bibleMap.getSize());

        var mapDistance = getDistance( mapExtent[0], mapExtent[1], mapExtent[2], mapExtent[3] );

        // mapDistance = mapDistance / 2;

        mapDistance  = mapDistance + (mapDistance * 0.8);

        mapExtent[0] -= mapDistance;
        mapExtent[1] -= mapDistance;

        mapExtent[2] += mapDistance;
        mapExtent[3] += mapDistance;

        var curZoom = view.getZoom();
        var mapExtentDistance = getDistance( mapExtent[0],mapExtent[1], mapExtent[2], mapExtent[3] );
        var mapCenter =  view.getCenter();
        var poiDistance = getDistance( mapCenter[0], mapCenter[1], poiObj.x, poiObj.y );
        var isFar = false;
        if( mapExtentDistance < poiDistance )
            isFar = true;

        var poiZoomIn = poiObj.zoomIn;
        var tolerance = 0.0;

        /*
        if (poiZoomIn < 6) {
            poiZoomIn = 7.8;
        } else {
            poiZoomIn -= 1;
        }
        */

        if (poiZoomIn < 8) {
            poiZoomIn = 8;
        }

        // if( curZoom < poiZoomIn ){
        if (IsIntersectExtent(mapExtent, poiObj.x, poiObj.y) == true) {
            poiZoomIn = curZoom;
        } else {
            tolerance = Math.abs(curZoom - poiZoomIn);
            //if (tolerance > 2) {
            if ( isFar == true ) {
                poiZoomIn = ( curZoom + poiZoomIn ) / 2.0;
            } else {
                poiZoomIn = curZoom;
            }
        }
        // if( tolerance > 2 ){
        if( isFar == true ) {
            flyTo(view, [poiObj.x, poiObj.y], poiZoomIn, function (complete) {
                if (complete == true) {
                }
            });
        }
        else
        {
            moveTo(view, [poiObj.x, poiObj.y], poiZoomIn);
        }

        saveLocationToStorage( poiZoomIn, poiObj.x, poiObj.y );

    };



/*
    function moveToPlaceByPoiObj( poiObj ){
        if( poiObj == null )
            return;


        // requestPoiContentAndShow( poiObj, popup2D, popup3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
        mobileRequestPoiContentAndShow( poiObj );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색

        var curZoom2D = bibleMap.getView().getZoom();

        var view2D = bibleMap.getView();
        var center2D = view2D.getCenter();
        var curExtent2D = view2D.calculateExtent(bibleMap.getSize());

        var extentLength2D = getDistance( curExtent2D[0], curExtent2D[1], curExtent2D[2], curExtent2D[3]);
        var moveDistance2D = getDistance( center2D[0], center2D[1], poiObj.x, poiObj.y );
        ///////////////////////////////////////////////////////////

        moveMap( moveDistance2D, extentLength2D, view2D, curZoom2D, poiObj );
    }
    */



    function deepMoveToPlaceByPoiObj( poiObj ){

        // mobileRequestPoiContentAndShow( poiObj );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
        requestPoiContentAndShow( poiObj, poiTooltip2D, poiTooltip3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색

        var view = bibleMap.getView();

        var mapExtent = bibleMap.getView().calculateExtent(bibleMap.getSize());
        var mapExtentDistance = getDistance( mapExtent[0],mapExtent[1], mapExtent[2], mapExtent[3] );
        var mapCenter =  bibleMap.getView().getCenter();
        var poiDistance = getDistance( mapCenter[0], mapCenter[1], poiObj.x, poiObj.y );

        var isFar = false;
        if( mapExtentDistance < poiDistance ) {
            isFar = true;
        }

        var poiZoomIn = poiObj.zoomIn -1;
        if( poiZoomIn > 11 )
            poiZoomIn += 1;

        saveLocationToStorage( poiZoomIn, poiObj.x, poiObj.y );

        if( isFar ){
            flyTo(view, [poiObj.x, poiObj.y], poiZoomIn, function (complete) {
                if (complete == true) {
                }
            });
        }
        else {
            moveTo(view, [poiObj.x, poiObj.y], poiZoomIn);
        }
    }


    function moveToPlaceByPoiObj( poiObj ){
        if( poiObj == null )
            return;

        requestPoiContentAndShow( poiObj, poiTooltip2D, poiTooltip3D );     // poi의  youtube나 기타 컨텐츠를 보여 줄수 있도록 mongodb 검색
        // map3D.create3DLabelLayer( null, poiObj.x, poiObj.y );

        var curZoom2D = bibleMap.getView().getZoom();

        var view2D = bibleMap.getView();
        var center2D = view2D.getCenter();
        var curExtent2D = view2D.calculateExtent(bibleMap.getSize());

        var extentLength2D = getDistance( curExtent2D[0], curExtent2D[1], curExtent2D[2], curExtent2D[3]);
        var moveDistance2D = getDistance( center2D[0], center2D[1], poiObj.x, poiObj.y );
        ///////////////////////////////////////////////////////////

        var curZoom3D = map3D.view.getZoom();

        var view3D = map3D.view;
        var center3D = view3D.getCenter();
        var curExtent3D = view3D.calculateExtent(map3D.map.getSize());

        var extentLength3D = getDistance( curExtent3D[0], curExtent3D[1], curExtent3D[2], curExtent3D[3]) * 8;
        var moveDistance3D = getDistance( center3D[0], center3D[1], poiObj.x, poiObj.y );

        // "chkView2D" |  "chkView3D"  | "chkViewAll"
        if( curMapViewMode == 'chkView2D' ){
            /// move2DMapOr3DMap( moveDistance2D, extentLength2D, view2D, curZoom2D, poiObj, "2D");
            move2DMap( moveDistance2D, extentLength2D, view2D, curZoom2D, poiObj );
        }

        if( curMapViewMode == 'chkView3D' ){
            // move3DMap( moveDistance3D, extentLength3D, view3D, curZoom2D, poiObj );
            move3DMap( view3D, poiObj );
        }

        if( curMapViewMode == 'chkViewAll' ){
            // move2DMapOr3DMap( moveDistance2D, extentLength2D, view2D, curZoom2D, poiObj, "2D");
            move2DMap( moveDistance2D, extentLength2D, view2D, curZoom2D, poiObj );

            // move3DMap( moveDistance3D, extentLength3D, view3D, curZoom2D, poiObj );
            move3DMap( view3D, poiObj );
        }

    }


    window.onload = function(){
        adjustScrDiv.normalScrMap();

        bibleChapterList.requestBibleChapter( );
    };

    window.onresize = function(){
        adjustScrDiv.showScrMap();
    };

    function createScaleBtns( divID, min, max  ) {

        var zoomInBtn2D = document.getElementById('zoomInBtn2D');
        var zoomOutBtn2D = document.getElementById('zoomOutBtn2D');

        var zoomInBtn3D = document.getElementById('zoomInBtn3D');
        var zoomOutBtn3D = document.getElementById('zoomOutBtn3D');

        var measureBtn2D = document.getElementById('measureBtn2D');

        var baseY = 150;

        /*
        if( divID == 'map')
            baseY = 230;
        else
            baseY = 100;
            */

        var intervalY = 10;

        var minLevel = min;
        var maxLevel = max;
        var mapViewId = divID;

        var levelLen = maxLevel - minLevel +1;

        if( divID == 'map') {
            zoomOutBtn2D.style.top = (baseY - 29) + 'px';
            zoomOutBtn2D.style.left = 5 + 'px';

            //zoomInBtn2D.style.top = ( (baseY - 30) + ( intervalY * levelLen ) ) + 'px';
            zoomInBtn2D.style.top = ( (baseY - 0) + ( intervalY * levelLen ) ) + 'px';
            // zoomInBtn2D.style.top = 260 + 'px';
            zoomInBtn2D.style.left = 5 + 'px';

            measureBtn2D.style.top = baseY - 70 +'px';
            measureBtn2D.style.left = 5 + 'px';
        }else {

            zoomOutBtn3D.style.top = (baseY - 29) + 'px';
            zoomOutBtn3D.style.left = 5 + 'px';

            // zoomInBtn3D.style.top = ( (baseY - 30) + ( intervalY * levelLen ) ) + 'px';
            zoomInBtn3D.style.top = ( (baseY - 0) + ( intervalY * levelLen ) ) + 'px';
            zoomInBtn3D.style.left = 5 + 'px';
        }


        var imgSrc1 = "biblemap/image/scale_btn.png?version=20170923";       // normal
        var imgSrc2 = "biblemap/image/scale_btn_.png?version=20170925";      // over
        var imgSrc3 = "biblemap/image/scale_btn__.png?version=20170925";     // click

        var clickedNumber = -1;

        var btnArr = [];

        function createScaleBtn( idx ) {
            var mapView = document.getElementById( divID );
            var btn = document.createElement("input");
            btn.src = imgSrc1;
            btn.type = "image";
            var strIdx = idx + "";
            // strIdx +=  mapViewId;
            // var strIdx = idx + "-" + mapViewId;
            btn.id = strIdx;
            // btn.setAttribute("id", strIdx );
            btn.setAttribute('clicked', "false" );
            // btn.setAttribute("border", "1px solid #1A75FF");
            // btn.setAttribute('style', "position: absolute; border: 1px solid #1A75FF; width: 20px; height: 10px; ");
            btn.setAttribute('style', "position: absolute; border: none; width: 20px; height: 10px; ");

            var strID = "#" + strIdx;
            $(strID).css("z-index", "2100");
            //$(strID).css("border", "1px solid #1A75FF");
            //$(strID).css("border", "none");

            var name_by_id = document.getElementById( strIdx);

            // btn.setAttribute('width', '23px');
            // btn.setAttribute('height', '8px');
            // btn.style.position = "absolute";
            btn.style.top = baseY + (idx * intervalY ) + "px";
            btn.style.left = "9px";

            btn.addEventListener('mouseover', mouseOverFunc, false );
            btn.addEventListener('mouseout', mouseOutFunc, false );

            function mouseOverFunc(){
                btn.src = imgSrc2;
            }

            function mouseOutFunc(){
                var clicked = btn.getAttribute('clicked');

                if( clicked == "true" ) {
                    btn.src = imgSrc3;
                    ConsoleLog( "mouseOut clicked !! " + clicked + ", src3" );
                }
                else {
                    btn.src = imgSrc1;
                    ConsoleLog( "mouseOut clicked !! " + clicked + ", src1" );
                }
            }

            btn.onclick = function( evt ) {

                if (clickedNumber > -1)
                    clearBtn(clickedNumber);

                var clickIdx = this.getAttribute('id');
                clickedNumber = parseInt(clickIdx);

                ConsoleLog("Clicked!!! " + clickIdx);

                var zoomLevel = parseInt(clickIdx) + minLevel;

                btn.setAttribute('clicked', "true");
                this.src = imgSrc3;

                if (mapViewId == "map") {
                    if( popup2D.content.innerHTML != "" ) {
                        ConsoleLog("clicked Popup!! " + popup2D.content.innerHTML);
                        _moveTo( bibleMapManager.getView(), popup2D.overlay.getPosition(), zoomLevel, 600);
                    }else{
                        var center = bibleMapManager.getView().getCenter();
                        _moveTo(bibleMapManager.getView(), center, zoomLevel, 600);
                    }

                } else {
                    if (popup3D.content.innerHTML != "") {
                        _moveTo(map3D.view, popup3D.position, zoomLevel, 600);
                    }
                    else {
                        var center = map3D.view.getCenter();
                        _moveTo(map3D.view, center, zoomLevel, 600);
                    }
                }
            };

            btnArr.push( btn );

            mapView.appendChild(btn);
        }

        function clearBtn( idx ){
            var btn = btnArr[idx];
            btn.src = imgSrc1;
            btn.setAttribute('clicked', "false" );
        }


        for( var idx = 0; idx < levelLen ; idx ++ ) {
            createScaleBtn( idx );
        }

        return function( viewLevel ){

            if( viewLevel > maxLevel )
                return;

            var level = Math.floor( viewLevel );

            var adjustLevel = level - minLevel;

            //   clearAllBtn();

            if( clickedNumber > -1 )
                clearBtn( clickedNumber );

            clickedNumber = adjustLevel;

            var btn = btnArr[ adjustLevel ];
            btn.setAttribute('clicked', "true" );
            btn.src = imgSrc3;
        }
    }

</script>

</body>
</html>